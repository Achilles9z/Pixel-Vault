<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-12HG5ZRG9K"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-12HG5ZRG9K');
</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PixelVault</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üõ°Ô∏è</text></svg>">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        :root { --red: #ff003c; --blue: #00f0ff; }
        body { font-family: 'Inter', sans-serif; background-color: #050505; color: #ffffff; }
        .cyber-card { background: #111; border: 1px solid #222; box-shadow: 0 20px 50px rgba(0,0,0,0.5); }
        .btn-red { background: var(--red); transition: transform 0.1s; }
        .btn-blue { background: var(--blue); color: black; transition: transform 0.1s; }
        button:active { transform: scale(0.96); }
        
        /* MOBILE FIX - Force visibility for all text */
        @media (max-width: 768px) {
            /* File input text */
            input[type="file"] {
                color: #ffffff !important;
                background-color: #000000 !important;
                border: 1px solid #333;
            }
            
            /* File input placeholder text */
            input[type="file"]::file-selector-button {
                color: #ffffff;
                background: #ff003c;
                border: none;
                padding: 8px 12px;
                border-radius: 6px;
                font-weight: bold;
                margin-right: 10px;
                cursor: pointer;
            }
            
            /* Status messages */
            .upload-status, 
            .file-status,
            #img-status,
            #file-status {
                color: #00f0ff !important;
                background-color: #111;
                padding: 8px 12px;
                border-radius: 6px;
                margin-top: 8px;
                font-size: 12px;
                word-break: break-all;
                border-left: 3px solid #111111;
                display: block !important;
            }
            
            /* The dashed border area in decode panel */
            .border-dashed {
                border-color: #111111 !important;
                background-color: #111;
            }
            
            /* All text inside decode panel */
            #decode-panel * {
                color: #ffffff;
            }
            
            /* Force all text to be visible */
            body, p, label, div, span, h1, h2, h3, button {
                color: #ffffff;
            }
            
            /* Exception for gray text that's supposed to be dim */
            .text-gray-400, 
            .text-gray-500 {
                color: #9ca3af !important;
            }
            
            /* Make sure cyber card has dark background */
            .cyber-card {
                background: #111 !important;
                border: 1px solid #333;
            }
            
            /* Fix for any white text on light background */
            .bg-black, .bg-gray-900, [class*="bg-"] {
                color: #ffffff;
            }
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center p-6">

    <header class="mb-10 text-center">
        <h1 class="text-5xl font-black tracking-tighter uppercase italic">
            Pixel<span class="text-[#ff003c]">Vault</span>
        </h1>
        <p class="text-gray-500 text-sm mt-2 font-medium">Hide any file inside a photo.</p>
    </header>

    <main class="w-full max-w-md cyber-card p-8 rounded-2xl">
        
        <div class="flex bg-black p-1 rounded-xl mb-8">
            <button onclick="switchTab('encode')" id="tab-encode" class="flex-1 py-2 text-sm font-bold rounded-lg bg-[#ff003c] text-white">HIDE</button>
            <button onclick="switchTab('decode')" id="tab-decode" class="flex-1 py-2 text-sm font-bold rounded-lg text-gray-400">REVEAL</button>
        </div>

        <div id="encode-panel" class="space-y-6">
            <div>
                <label class="text-xs font-bold text-gray-400 uppercase mb-2 block">1. Pick a Photo</label>
                <input type="file" id="img-input" accept="image/*" class="w-full bg-black border border-gray-800 p-3 rounded-lg text-xs file:hidden cursor-pointer hover:border-gray-600">
                <div id="img-status" class="upload-status text-xs text-[#00f0ff] mt-2 font-mono hidden"></div>
            </div>
            <div>
                <label class="text-xs font-bold text-gray-400 uppercase mb-2 block">2. File to Hide</label>
                <input type="file" id="file-input" class="w-full bg-black border border-gray-800 p-3 rounded-lg text-xs file:hidden cursor-pointer hover:border-gray-600">
                <div id="file-status" class="upload-status text-xs text-[#00f0ff] mt-2 font-mono hidden"></div>
            </div>
            <button onclick="handleEncode()" id="encode-btn" class="btn-red w-full py-4 rounded-xl font-black uppercase text-sm tracking-wider">Download Hidden Image</button>
        </div>

        <div id="decode-panel" class="hidden space-y-6">
            <div class="text-center">
                <label class="text-xs font-bold text-gray-400 uppercase mb-4 block">Upload the Encoded Photo</label>
                <div class="border-2 border-dashed border-gray-800 p-10 rounded-2xl">
                    <input type="file" id="decode-input" accept="image/*" class="text-xs text-gray-500">
                </div>
                <div id="decode-status" class="upload-status text-xs text-[#00f0ff] mt-2 font-mono hidden"></div>
            </div>
            <button onclick="handleDecode()" id="decode-btn" class="btn-blue w-full py-4 rounded-xl font-black uppercase text-sm tracking-wider">Extract Hidden File</button>
        </div>

    </main>

    <script>
        const MARKER = "---PV-VAULT---";

        // File name display for mobile
        document.getElementById('img-input').addEventListener('change', function(e) {
            const statusDiv = document.getElementById('img-status');
            if(e.target.files[0]) {
                statusDiv.innerHTML = '‚úÖ <span class="text-white">' + e.target.files[0].name + '</span>';
                statusDiv.classList.remove('hidden');
            } else {
                statusDiv.classList.add('hidden');
            }
        });

        document.getElementById('file-input').addEventListener('change', function(e) {
            const statusDiv = document.getElementById('file-status');
            if(e.target.files[0]) {
                statusDiv.innerHTML = 'üì¶ <span class="text-white">' + e.target.files[0].name + '</span>';
                statusDiv.classList.remove('hidden');
            } else {
                statusDiv.classList.add('hidden');
            }
        });

        document.getElementById('decode-input').addEventListener('change', function(e) {
            const statusDiv = document.getElementById('decode-status');
            if(e.target.files[0]) {
                statusDiv.innerHTML = 'üîì <span class="text-white">' + e.target.files[0].name + '</span>';
                statusDiv.classList.remove('hidden');
            } else {
                statusDiv.classList.add('hidden');
            }
        });

        function switchTab(tab) {
            const isEncode = tab === 'encode';
            document.getElementById('encode-panel').classList.toggle('hidden', !isEncode);
            document.getElementById('decode-panel').classList.toggle('hidden', isEncode);
            
            const encodeBtn = document.getElementById('tab-encode');
            const decodeBtn = document.getElementById('tab-decode');

            if(isEncode) {
                encodeBtn.className = "flex-1 py-2 text-sm font-bold rounded-lg bg-[#ff003c] text-white";
                decodeBtn.className = "flex-1 py-2 text-sm font-bold rounded-lg text-gray-400";
            } else {
                decodeBtn.className = "flex-1 py-2 text-sm font-bold rounded-lg bg-[#00f0ff] text-black";
                encodeBtn.className = "flex-1 py-2 text-sm font-bold rounded-lg text-gray-400";
            }
        }

        async function handleEncode() {
            const btn = document.getElementById('encode-btn');
            const imgFile = document.getElementById('img-input').files[0];
            const secretFile = document.getElementById('file-input').files[0];
            
            if (!imgFile || !secretFile) {
                alert("Please select both files.");
                return;
            }

            btn.innerText = "PROCESSING...";
            
            const imgBuffer = await imgFile.arrayBuffer();
            const secretBuffer = await secretFile.arrayBuffer();
            const meta = new TextEncoder().encode(MARKER + secretFile.name + MARKER);
            
            const combined = new Uint8Array(imgBuffer.byteLength + meta.byteLength + secretBuffer.byteLength);
            combined.set(new Uint8Array(imgBuffer), 0);
            combined.set(meta, imgBuffer.byteLength);
            combined.set(new Uint8Array(secretBuffer), imgBuffer.byteLength + meta.byteLength);

            const a = document.createElement('a');
            a.href = URL.createObjectURL(new Blob([combined], { type: imgFile.type }));
            a.download = `hidden_${imgFile.name}`;
            a.click();
            
            btn.innerText = "DONE!";
            setTimeout(() => btn.innerText = "Download Hidden Image", 2000);
        }

        async function handleDecode() {
            const btn = document.getElementById('decode-btn');
            const file = document.getElementById('decode-input').files[0];
            if (!file) {
                alert("Select a photo first.");
                return;
            }

            btn.innerText = "EXTRACTING...";
            
            const buffer = await file.arrayBuffer();
            const uint8 = new Uint8Array(buffer);
            const binaryString = new TextDecoder().decode(uint8);
            const parts = binaryString.split(MARKER);

            if (parts.length < 3) {
                btn.innerText = "ERROR: NO DATA";
                setTimeout(() => btn.innerText = "Extract Hidden File", 2000);
                alert("No hidden file found in this image.");
                return;
            }

            const fileName = parts[1];
            const markerEncoded = new TextEncoder().encode(MARKER);
            let count = 0, secondIdx = -1;
            for(let i=0; i<uint8.length; i++) {
                let match = true;
                for(let j=0; j<markerEncoded.length; j++) {
                    if(uint8[i+j] !== markerEncoded[j]) { 
                        match=false; 
                        break; 
                    }
                }
                if(match) { 
                    count++; 
                    if(count===2) { 
                        secondIdx=i; 
                        break; 
                    }
                }
            }

            const payload = uint8.slice(secondIdx + markerEncoded.length);
            const a = document.createElement('a');
            a.href = URL.createObjectURL(new Blob([payload]));
            a.download = fileName;
            a.click();
            
            btn.innerText = "SUCCESS!";
            setTimeout(() => btn.innerText = "Extract Hidden File", 2000);
        }
    </script>
</body>
</html>
